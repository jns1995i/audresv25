<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <link rel="stylesheet" href="/style.css">
    <link rel="icon" href="/images/logo.png">
    <title><%= title ? `${title}` : 'AUDRES25' %></title>
    <style>
  body {
    overflow-y: auto !important;
    display: block !important;
    padding: 5px;
  }
  .mainF {
    height: auto !important;
  }
  .leftF {
    align-self: start !important;
    justify-content: start !important;
  }
  #headF {
    align-items: start;
    position: initial !important;
    top: initial !important;
    left: initial !important;
    transform: none !important;
  }
  .gemF {
      height: 200px !important;
      img {
          height: 150px;
      }
  }
  .rem48 {
      font-size: 3rem;
  }
  .rem48.p2 {
      margin-top: -2rem !important;
      font-size: 3rem;
  }
  .rem48.p1 {
      font-size: 3rem;
  }
  .logoF {
      height: 60px;
      width: 60px;
      position: absolute;
      top: 30% !important;
      left: 53% !important;
  }
  img.logo {
      height: 70%;
  }
    body::-webkit-scrollbar { display: initial; }
      @media (max-width: 1024px) {
        body {
            display: block;
            overflow-y: auto;
            height: 100vh;
        }
        body::-webkit-scrollbar { display: none; }
        .mainF {
            flex-direction: column;
            height: auto;
            margin-bottom: 50px !important;
        }
        .leftF {
          height: auto !important;
            width: 100%;
        }
        .gemF {
          height: auto !important;
            margin-top: 0 !important;
            img {
                height: 70px;
            }
        }
        .logoF {
            height: 30px;
            width: 30px;
            position: absolute;
            top: 35% !important;
            left: 53% !important;
        }
        img.logo {
            height: 70%;
        }
        .rem48 {
            font-size: 3rem;
        }
        .rem48.p2 {
            margin-top: -2rem !important;
        }
        .rem48.p1 {
            margin-top: -1.6rem !important;
        }
        .rightF {
            height: fit-content;
            width: 100%;
            padding-block: 0 !important;
            margin-bottom: 100px !important;
        }
        #headF {
            flex-direction: column-reverse !important;
        }
        .crd {
          display: none !important;
        }
         .colF1 {
          flex-direction: column !important;
          .field {
            width: 100%;
          }
         }
         .sbBtn {
            width: 100%;
            text-align: center;
            justify-content: center;
         }
         
        .gradientText {
        background: linear-gradient(to bottom,white,  white, var(--tint8));
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow:
            0 0 10px rgba(255, 255, 255, 0.2),
            0 0 8px rgba(61, 77, 255, 0.3),
            0 0 10px rgba(255, 255, 255, 0.2);
            color-scheme: light !important;
            -webkit-print-color-adjust: exact; /* prevent color alterations */
            -webkit-text-fill-color: initial; /* reset text fill */
            print-color-adjust: exact;    
        }
      }
    </style>
</head>
<body class="abstractBG">
  

    <img src="/images/au.png" alt="" class="absolute top0 right0 scale3 bgWhite corner500" style="opacity: 0.05; filter: grayscale(0.9); z-index: 0;" id="watermark">

    <div class="mainF" style="z-index: 500 !important;">
        <div class="height0 padding20 col justifyStart relative leftF width40">
            
            <div class="height0 col" id="headF">
                <p class="rem48 gradientText textWrap textCenter glowImg3 p1">AU Registrar Document</p>
                <p class="rem48 gradientText textWrap textCenter glowImg3 p2" style="margin-top: -3.6rem;">Request System</p>
                <div class="h400 padding10 gemF relative" style="margin-top: -3rem;">
                    <img src="/images/gold.png" alt="" class="height100 glowImg" style="transform: rotate(-10deg);">
                    
                    <div class="corner500 h80 liquid borderWhite absolute w80 logoF glowImg2"  style="left: 55%; top: 30%;">
                        <img src="/images/au.png" alt="" class="logo corner500 height80 bgWhite opacity7">
                    </div>
                </div>
            </div>
            

            
            <div class="height0 gap10 marginBottom20" id="rateF">
                <div class="height0 width0">
                    <p>Average Rating: <%= ratings.averageRating.toFixed(1) %> ⭐ &nbsp; | &nbsp; <%= ratings.totalRatings %> votes</p>
                </div>
            </div>

            <div class="bgWhite index50 col justifyStart height0 colorPrimary cornerRem1" id="">
                <div class="height0 col justifyCenter alignStart padding20 relative">
                    <p class="rem2 str500 marginBottom10">Data Privacy Notice</p>
                    <p class="rem11 str400 textJustify">
                        By submitting this form, you agree to provide your personal details and valid ID for identity verification purposes only. All information collected will be treated as confidential and will be used solely for processing your document request. In compliance with the Data Privacy Act of 2012, your data will be securely stored and accessed only by authorized personnel from the Registrar’s Office. Your information will not be shared with third parties and will be retained only as necessary.
                    </p>
                </div>
            </div>

        </div>
        
        <div class="padding20 rightF width45 col height0 relative" style="z-index: 100 !important;">
            
            <div class="height0 paddingInline10 paddingBlock10 justifyStart"><a href="/" class="nav liquid"><i class="fas fa-chevron-left"></i> Go Back to Login</a></div>

            <form action="/reqDirect" method="POST" enctype="multipart/form-data" class="padding30 card alignCenter relative colorPrimary" style="z-index: 100;">
                <div class="col justifyStart alignStart gap10 relative">
                    <p class="size28 str500 colorPrimary">REQUEST FORM</p>
                </div>
                <div class="col height0 alignStart gap5" id="editCard">
                        <div class="fieldsetsContainer col height0 padding0 width100" id="fieldsetsContainer">
                            <fieldset class="marginBottom10">
                                <div class="height0 justifyEnd hidden" id="removeDocCard"><a href="javascript:void(0)" class="nav dnav" id="removeDoc">Remove</a></div>
                                <div class="row gap10  colF1">
                                    <div class="field">
                                        <Label>Document Type</Label>
                                        <div class="selectBar">
                                            <select class="document-type" name="type[]" onchange="handleDocumentTypeChange(this)" required>
                                                <option value="">Select</option>
                                                <% documents.forEach(doc => { %>
                                                    <option value="<%= doc.type %>"><%= doc.type %></option>
                                                <% }) %>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label>No. Copies</label>
                                        <input name="qty[]" type="number" id="number" class="cpy" required>
                                    </div>
                                </div>
                                <div class="row gap10 marginTop10">
                                    <div class="field additional-options">
                                        <label>Purpose</label>
                                        <div class="selectBar">
                                            <select class="document-options" name="purpose[]" onchange="handleOptionChange(this)" required>
                                                <option value="">Select</option>
                                                <option value="Board Exam">Board Exam</option>
                                                <option value="Reference">Reference</option>
                                                <option value="Requirement for Other School">Requirement for Other School</option>
                                                <option value="Scholarship">Scholarship</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="field upload hidden marginTop10">
                                    <label class="str500">Please upload photo of School Request</label>
                                    <input type="file" name="reqPhoto[]" class="bgYellow">
                                </div>
                                <p class="bgRed100 limitPhoto hidden marginTop10">Photo must not be larger than 500MB.</p>
                                <script>
                                document.addEventListener("DOMContentLoaded", () => {
                                const input = document.querySelector('input[name="reqPhoto[]"]');
                                const warning = document.querySelector('.limitPhoto');

                                input.addEventListener('change', function () {
                                    warning.classList.add("hidden");

                                    if (this.files.length > 0) {
                                    const file = this.files[0];
                                    const maxSize = 500 * 1024 * 1024; // 500MB

                                    if (file.size > maxSize) {
                                        warning.textContent = "Photo must not be larger than 500MB.";
                                        warning.classList.remove("hidden");
                                        this.value = ""; // clear file input
                                    }
                                    }
                                });
                                });
                                </script>
                                <br>
                                <label class="rem1 marginBottom5 hidden">If applicable:</label>
                                <div class="row gap10  colF1">
                                    <div class="field">
                                        <label for="">School Year</label>
                                        <div class="selectBar">
                                            <select name="schoolYear[]" id="schoolYear">
                                                <option value="" selected disabled>Select</option>
                                                <% for (let year = 2025; year >= 1990; year--) { %>
                                                    <option value="<%= year %>-<%= year + 1 %>">
                                                        <%= year %>-<%= year + 1 %>
                                                    </option>
                                                <% } %>
                                            </select>                                
                                        </div>
                                    </div>
                                    <div class="field">
                                        <label for="">Semester</label>
                                        <div class="selectBar">
                                            <select name="semester[]" id="">
                                                <option value="First">First</option>
                                                <option value="Second">Second</option>
                                                <option value="Summer">Summer</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="field">
                                    <span class="totalAmount marginTop10"></span>
                                </div>
                            </fieldset>
                        </div>
                        <p class="height0 bgBlue100 hidden textCenter" id="warning1"><i class="fas fa-exclamation-circle"></i> Please fill out all the required fields before adding a new one!</p>
                        <div class="height0 bgSoft darkGray corner10 padding10 textCenter str500 width100 justifyCenter alignCenter"><i class="fas fa-info-circle marginRight5"></i> Dismissal Form &nbsp; <a href="" class="underline colorPrimary str500 width0 padding0 margin0 size12">Download Here</a></div>
                        <div class="height0 justifyBetween padding5">
                            <p class=" str500">Need Another Document?</p>
                            <a href="javascript:void(0)" class="nav pnav" id="addDoc"><i class="fas fa-plus"></i> Additional</a>
                        </div>
                        <div class="height0 bgBlue100 textCenter"> Your total payable amount is &nbsp; <span id="grandTotal"> ₱0.00</span></div>

                        <br><hr><br>

                    <div class="field">
                        <p class="rem16 str500">Personal Information</p>
                    </div>
                    <br>

                        
                    <div class="row height0 width100 gap10 colF1">
                        <div class="field gap5 width30">
                            <label for="">First Name*</label>
                            <input type="text" name="firstName" class="sname" required>
                        </div>
                        <div class="field gap5 width30">
                            <label for="">Middle Name</label>
                            <input type="text" name="middleName" class="sname">
                        </div>
                        <div class="field gap5 width30">
                            <label for="">Last Name*</label>
                            <input type="text" name="lastName" class="sname" required>
                        </div>
                        <div class="field gap5 width10">
                            <label for="">Ext</label>
                            <input type="text" name="extName" class="sname">
                        </div>
                    </div>
                    <script>
                        function enforceNameFormat(event) {
                            // Allow only letters and dash
                            event.target.value = event.target.value.replace(/[^A-Za-z-.\s]/g, '');
                        }

                        document.addEventListener('DOMContentLoaded', () => {
                            const nameInputs = document.querySelectorAll('.sname');
                            nameInputs.forEach(input => {
                                input.addEventListener('input', enforceNameFormat);
                            });
                        });
                    </script>

                    <div class="row height0 width100 gap10 colF1">
                        <div class="field gap5">
                            <label for="">Address*</label>
                            <input type="text" name="address" required>
                        </div>
                    </div>
                    <div class="row height0 width100 gap10 colF1">
                        <div class="field col alignStart gap5">
                            <label for="birthday">Birthday*</label>
                            <div class="height0 gap5">
                                <div class="selectBar">
                                    <select id="bMonth" name="bMonth" required>
                                        <option value="">Month</option>
                                    </select>
                                </div>
                                <div class="selectBar">
                                    <select id="bDay" name="bDay" required>
                                        <option value="">Day</option>
                                    </select>
                                </div>
                                <div class="selectBar">
                                    <select id="bYear" name="bYear" required>
                                        <option value="">Year</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="height0 width100 gap10 alignEnd colF1">
                        <div class="field gap5">
                            <label for="">Active PHINMA AU or Personal Email*</label>
                            <input type="email" name="email" id="em" required>
                        </div>
                        <div class="field gap5">
                            <label for="">Phone Number*</label>
                            <input type="text" id="number" name="number" inputmode="numeric" required class="number">
                        </div>
                        <script>
                            document.getElementById('em').addEventListener('input', function () {
                                const email = this.value;
                            
                                fetch(`/check-email?email=${encodeURIComponent(email)}`)
                                    .then(response => response.json())
                                    .then(data => {
                                        const errorMsg = document.getElementById('error');
                                        if (data.exists) {
                                            errorMsg.classList.remove('hidden');
                                        } else {
                                            errorMsg.classList.add('hidden');
                                        }
                                    });
                            });
                        </script>
                    </div>
                    
                    <div class="bgRed100 hidden width0" id="error">Email is already used by an existing account!</div>

                    <br><hr><br>
                    <div class="row height0 gap10 colF1">
                        <div class="field gap5 height0">
                            <label for="">Type of Student*</label>
                            <div class="selectBar">
                                <select name="role" id="role" required>
                                    <option value="" selected disabled>Select</option>
                                    <option value="Student">Current Student</option>
                                    <option value="Alumni">Alumni</option>
                                    <option value="Former">Former Students or Transferred to other School</option>
                                </select>
                            </div>
                        </div>
                        <div class="field gap5">
                            <label for="">Campus*</label>
                            <div class="selectBar">
                                <select name="campus" id="campus" required>
                                    <option value="" selected disabled>Select</option>
                                    <option value="Main">Main</option>
                                    <option value="South">South</option>
                                    <option value="San Jose">San Jose</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="height0 gap10 colF1">
                        <div class="field gap5">
                            <div class="height0 justifyBetween">
                                <label for="sn" id="snLabel">Student Number <span class="hidden">(Optional)</span></label>
                            </div>
                            <input type="text" id="sn" name="studentNo" placeholder="e.g. 01-1920-032235">
                        </div>
                        <script>
                            function enforceStudentNumberFormat(event) {
                                // Allow only digits and dash
                                event.target.value = event.target.value.replace(/[^0-9-]/g, '');
                            }

                            document.addEventListener('DOMContentLoaded', () => {
                                const snInput = document.querySelector('#sn');
                                snInput.addEventListener('input', enforceStudentNumberFormat);
                            });
                        </script>
                        <script>
                        const roleSelect = document.getElementById('role');
                        const snInput = document.getElementById('sn');
                        const snLabel = document.getElementById('snLabel');
                        const optionalSpan = snLabel.querySelector('span');

                        roleSelect.addEventListener('change', () => {
                            const selected = roleSelect.value;

                            if (selected === 'Student') {
                                snInput.required = true;
                                optionalSpan.classList.add('hidden');
                            } else {
                                snInput.required = false;
                                optionalSpan.classList.remove('hidden');
                            }
                        });
                        </script>
                        <script>
                            document.getElementById('sn').addEventListener('input', function () {
                                const studentNo = this.value;
                            
                                fetch(`/check-studentNo?studentNo=${encodeURIComponent(studentNo)}`)
                                    .then(response => response.json())
                                    .then(data => {
                                        const errorMsg = document.getElementById('error2');
                                        if (data.exists) {
                                            errorMsg.classList.remove('hidden');
                                        } else {
                                            errorMsg.classList.add('hidden');
                                        }
                                    });
                            });
                        </script>
                        <script>
                            document.getElementById("role").addEventListener("change", function() {
                                const role = this.value;
                                const yearLevelField = document.getElementById("yearLevelField");
                                const yearLevelSelect = document.getElementById("yearLevel");

                                // Clear previous options
                                yearLevelSelect.innerHTML = "";

                                if (role === "Alumni") {
                                    // Show only Graduated
                                    const option = document.createElement("option");
                                    option.value = "Graduated";
                                    option.textContent = "Graduated";
                                    option.selected = true;
                                    yearLevelSelect.appendChild(option);
                                    yearLevelField.classList.remove("hidden");
                                } else if (role === "Student" || role === "Former") {
                                    const options = [
                                        "First Year","Second Year","Third Year","Fourth Year",
                                        "Grade 11","Grade 12","Year 1","Year 2","Year 3"
                                    ];

                                    const defaultOption = document.createElement("option");
                                    defaultOption.value = "";
                                    defaultOption.textContent = "Select";
                                    defaultOption.disabled = true;
                                    defaultOption.selected = true;
                                    yearLevelSelect.appendChild(defaultOption);

                                    options.forEach(opt => {
                                        const option = document.createElement("option");
                                        option.value = opt;
                                        option.textContent = opt;
                                        yearLevelSelect.appendChild(option);
                                    });

                                    yearLevelField.classList.remove("hidden");
                                } else {
                                    yearLevelField.classList.add("hidden");
                                }
                            });

                            // ⭐ Run once on page load to set default correctly
                            document.getElementById("role").dispatchEvent(new Event("change"));
                        </script>

                        <div class="field height0 col alignStart gap5 hidden" id="yearGraduateContainer">
                            <label for="yearGraduate">Year Graduated</label>
                            <input type="text" id="yearGraduate" name="yearGraduated">
                        </div>
                        <div class="field height0 col alignStart gap5 hidden" id="yearAttendedContainer">
                            <label for="yearAttended">Year Last Attended</label>
                            <input type="text" id="yearAttended" name="yearAttended">
                        </div>
                    </div>
                    
                    <div class="bgRed100 width0 hidden" id="error2">Student number is already registered!</div>
                    <div class="row height0 gap10 colF1">
                        <div class="field height0 col alignStart gap5 hidden" id="yearLevelField">
                            <label for="yearLevel">Year Level</label>
                            <div class="selectBar">
                                <select name="yearLevel" id="yearLevel">
                                    <option value="" selected disabled>Select</option>
                                    <option value="First Year">First Year</option>
                                    <option value="Second Year">Second Year</option>
                                    <option value="Third Year">Third Year</option>
                                    <option value="Fourth Year">Fourth Year</option>
                                    <option value="Grade 11">Grade 11</option>
                                    <option value="Grade 12">Grade 12</option>
                                    <option value="Year 1"> Year 1 (Grad School)</option>
                                    <option value="Year 2"> Year 2 (Grad School)</option>
                                    <option value="Year 3"> Year 3 (Grad School)</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row height0 width100 gap10 colF1">
                        <div class="field gap5">
                            <label for="">Course or Strand*</label>
                            <div class="selectBar">
                                <select name="course" required>
                                    <option value="" selected disabled>Select</option>
                                    <option value="Bachelor of Arts in Political Science">Bachelor of Arts in Political Science</option>
                                    <option value="Bachelor of Early Childhood Education">Bachelor of Early Childhood Education</option>
                                    <option value="Bachelor of Elementary Education">Bachelor of Elementary Education</option>
                                    <option value="Bachelor of Science in Accountancy">Bachelor of Science in Accountancy</option>
                                    <option value="Bachelor of Science in Accounting Information System">Bachelor of Science in Accounting Information System</option>
                                    <option value="Bachelor of Science in Business Administration - Banking and Microfinance">Bachelor of Science in Business Administration - Banking and Microfinance</option>
                                    <option value="Bachelor of Science in Business Administration - Financial Management">Bachelor of Science in Business Administration - Financial Management</option>
                                    <option value="Bachelor of Science in Business Administration - Human Resource Management">Bachelor of Science in Business Administration - Human Resource Management</option>
                                    <option value="Bachelor of Science in Business Administration - Marketing Management">Bachelor of Science in Business Administration - Marketing Management</option>
                                    <option value="Bachelor of Science in Civil Engineering">Bachelor of Science in Civil Engineering</option>
                                    <option value="Bachelor of Science in Criminology">Bachelor of Science in Criminology</option>
                                    <option value="Bachelor of Science in Electrical Engineering">Bachelor of Science in Electrical Engineering</option>
                                    <option value="Bachelor of Science in Entrepreneurship">Bachelor of Science in Entrepreneurship</option>
                                    <option value="Bachelor of Science in Hospitality Management">Bachelor of Science in Hospitality Management</option>
                                    <option value="Bachelor of Science in Information Technology">Bachelor of Science in Information Technology</option>
                                    <option value="Bachelor of Science in Management Accounting">Bachelor of Science in Management Accounting</option>
                                    <option value="Bachelor of Science in Medical Laboratory Science">Bachelor of Science in Medical Laboratory Science</option>
                                    <option value="Bachelor of Science in Nursing">Bachelor of Science in Nursing</option>
                                    <option value="Bachelor of Science in Pharmacy">Bachelor of Science in Pharmacy</option>
                                    <option value="Bachelor of Science in Psychology">Bachelor of Science in Psychology</option>
                                    <option value="Bachelor of Secondary Education - English">Bachelor of Secondary Education - English</option>
                                    <option value="Bachelor of Secondary Education - Filipino">Bachelor of Secondary Education - Filipino</option>
                                    <option value="Bachelor of Secondary Education - Mathematics">Bachelor of Secondary Education - Mathematics</option>
                                    <option value="Bachelor of Secondary Education - Science">Bachelor of Secondary Education - Science</option>
                                    <option value="Doctor of Philosophy major in Educational Management">Doctor of Philosophy major in Educational Management</option>
                                    <option value="Doctor of Philosophy major in Filipino">Doctor of Philosophy major in Filipino</option>
                                    <option value="Doctor of Philosophy major in Psychology and Guidance">Doctor of Philosophy major in Psychology and Guidance</option>
                                    <option value="Doctor of Philosophy major in Science Education">Doctor of Philosophy major in Science Education</option>
                                    <option value="Master of Arts Major in Educational Management (Thesis & Non-Thesis)">Master of Arts Major in Educational Management (Thesis & Non-Thesis)</option>
                                    <option value="Master of Arts Major in English (Thesis & Non-Thesis)">Master of Arts Major in English (Thesis & Non-Thesis)</option>
                                    <option value="Master of Arts Major in Guidance and Counseling (Thesis & Non-Thesis)">Master of Arts Major in Guidance and Counseling (Thesis & Non-Thesis)</option>
                                    <option value="Master of Arts Major in Mathematics (Thesis & Non-Thesis)">Master of Arts Major in Mathematics (Thesis & Non-Thesis)</option>
                                    <option value="Master of Arts Major in Physical Education (Thesis & Non-Thesis)">Master of Arts Major in Physical Education (Thesis & Non-Thesis)</option>
                                    <option value="Master of Arts Major in Psychology (Thesis & Non-Thesis)">Master of Arts Major in Psychology (Thesis & Non-Thesis)</option>
                                    <option value="Master of Arts Major in Public Management">Master of Arts Major in Public Management</option>
                                    <option value="Master of Arts Major in Science Education">Master of Arts Major in Science Education</option>
                                    <option value="Master of Science in Business Administration major in Management">Master of Science in Business Administration major in Management</option>
                                    <option value="ABM Specializes in Hospitality and Tourism">ABM Specializes in Hospitality and Tourism</option>
                                    <option value="GAS - Criminology">GAS - Criminology</option>
                                    <option value="GAS - Education">GAS - Education</option>
                                    <option value="GAS - Information Technology">GAS - Information Technology</option>
                                    <option value="HUMSS">HUMSS</option>
                                    <option value="STEM">STEM</option>
                                    <option value="STEM Health (Nursing, Pharmacy, Medical Laboratory Science, Psychology)">STEM Health (Nursing, Pharmacy, Medical Laboratory Science, Psychology)</option>
                                </select>                        
                            </div>
                        </div>
                    </div>
                    <br>
                    <div id="idList" class="heigth100 bgWhite index100 height0 colorPrimary alignEnd relative cornerRem1 padding20 borderPrimary" style="z-index: 200 !important;">
                        <a href="javascript:void(0)" class="nav cnav absolute right10 top10 hidden" id="xBtn"><i class="fas fa-times"></i></a>
                        <div class="height0 col alignStart gap5">
                            <p class="rem16 str500">Uploading Valid ID Guidelines</p>
                            <p class="rem1 str400">To complete your request, you must upload a valid government-issued or school ID. This is required for identity verification and ensures your request is securely processed.</p>
                            <br>
                            <p class="rem16 str500">Accepted IDs</p>
                            <hr class="width90">
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> School ID</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Phinma Alumni ID</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Philippine Passport</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Driver’s License</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Unified Multi-Purpose ID (UMID) / SSS ID</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> PhilSys National ID</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> GSIS e-Card</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> PRC ID</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Postal ID</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Voter’s ID / Voter’s Certification</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Alien Certificate of Registration (ACR)</p>
                            <p class="size12 str500"><i class="fas fa-check-circle"></i> Firearms License (PNP-issued)</p>
                            <br>
                            <p class="rem16 str500">Requirements</p>
                            <hr class="width90">
                            <p class="size12 str500">1. The ID must clearly show your full name & photo.</p>
                            <p class="size12 str500">2. The uploaded file must be in JPG, JPEG or PNG format.</p>
                            <p class="size12 str500">3. Maximum file size: 10 MB.</p>
                            <p class="size12 str500">4. Ensure the ID is legible and not expired.</p>
                        </div>
                    </div>
                    <div class="field gap5">
                        <label for="" class="relative width100">Upload Valid ID </label>
                        <input type="file" name="vId" required>
                    </div>
                    <p class="bgRed100 limitPhoto2 hidden marginTop10">Photo must not be larger than 500MB.</p>
                    <script>
                    document.addEventListener("DOMContentLoaded", () => {
                    const input = document.querySelector('input[name="vId"]');
                    const warning = document.querySelector('.limitPhoto2');

                    input.addEventListener('change', function () {
                        warning.classList.add("hidden");

                        if (this.files.length > 0) {
                        const file = this.files[0];
                        const maxSize = 500 * 1024 * 1024; // 500MB

                        if (file.size > maxSize) {
                            warning.textContent = "Photo must not be larger than 500MB.";
                            warning.classList.remove("hidden");
                            this.value = ""; // clear file input
                        }
                        }
                    });
                    });
                    </script>
                </div>  
                <div class="height0 row marginBlock15">
                    <p class="size12 flex textCenter"><input type="checkbox" class="width0 marginRight10" required> I have read and understood the DATA PRIVACY NOTICE</p>
                </div>
                <div class="bgYellow cornerRem1 padding20 textCenter">
                    TAKE NOTE: Please review all the details carefully before submitting your request. Ensure that all selections and information are correct, as changes may not be allowed after submission.
                </div>
                <div class="field height0 marginTop15 width100 alignEnd">
                    <button type="submit" class="nav tnav pnav sbBtn"><i class="fas fa-check-circle"></i>Submit</button>
                </div>
            </form>
        </div>
    </div>

    <script>
    document.querySelectorAll('.showPass').forEach(button => {
        button.addEventListener('click', function() {
            const passwordInput = button.previousElementSibling;
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                button.textContent = 'hide';
            } else {
                passwordInput.type = 'password';
                button.textContent = 'show';
            }
        });
    });
</script>

 <script>
    document.addEventListener("DOMContentLoaded", () => {
    const idBtn = document.getElementById("idBtn");
    const xBtn = document.getElementById("xBtn");
    const idList = document.getElementById("idList");

    idBtn.addEventListener("click", () => {
        idList.classList.remove("hidden");
    });

    xBtn.addEventListener("click", (e) => {
        e.preventDefault();
        idList.classList.add("hidden");
    });
    });
</script>
<script>
    // Wait for the DOM to fully load
    document.addEventListener("DOMContentLoaded", function () {
        const dpn = document.getElementById('dpn');
        const dpnCard = document.getElementById('dpnCard');
        const dpnClose = document.getElementById('dpnClose');

        // Show the div when <a> is clicked
        dpn.addEventListener('click', function (e) {
            e.preventDefault(); // prevent page jump
            dpnCard.classList.remove('hidden');
        });

        // Hide the div when Close button is clicked
        dpnClose.addEventListener('click', function () {
            dpnCard.classList.add('hidden');
        });
    });
</script>
<script>
    document.getElementById("role").addEventListener("change", function() {
    var role = this.value;
    
    // Hide both fields initially
    document.getElementById("yearGraduateContainer").classList.add("hidden");
    document.getElementById("yearAttendedContainer").classList.add("hidden");

    // Show the correct field based on role selection
    if (role === "Alumni") {
        document.getElementById("yearGraduateContainer").classList.remove("hidden");
    } else if (role === "Former") {
        document.getElementById("yearAttendedContainer").classList.remove("hidden");
    }
});

</script>

<script>
    function enforcePhoneInput(event) {
        event.target.value = event.target.value.replace(/[^0-9]/g, '').slice(0, 11);
    }

    document.addEventListener('DOMContentLoaded', () => {
        const phoneInputs = document.querySelectorAll('.number');
        phoneInputs.forEach(input => {
            input.addEventListener('input', enforcePhoneInput);
        });
    });
</script>

<script>
    function enforceCopyInput(event) {
        event.target.value = event.target.value.replace(/[^1-9]/g, '').slice(0, 1);
    }

    document.addEventListener('DOMContentLoaded', () => {
        const copyInputs = document.querySelectorAll('.cpy');
        copyInputs.forEach(input => {
            input.addEventListener('input', enforceCopyInput);
        });
    });
</script>

<script>
let documentPrices = {};

document.addEventListener("DOMContentLoaded", async () => {
    try {
        const res = await fetch('/documents/prices');
        documentPrices = await res.json();
        console.log("✅ Document prices loaded:", documentPrices);

        // Initialize existing fieldset
        const container = document.getElementById("fieldsetsContainer");
        const firstFieldset = container.querySelector("fieldset");
        const typeSelect = firstFieldset.querySelector("select[name='type[]']");
        handleDocumentTypeChange(typeSelect);
    } catch (err) {
        console.error("⚠️ Failed to load document prices:", err);
    }
});

// Handle document type change for a specific fieldset
function handleDocumentTypeChange(select) {
    const fieldset = select.closest("fieldset");
    const optionsSelect = fieldset.querySelector(".document-options");
    const uploadDiv = fieldset.querySelector(".upload");
    const fileInput = uploadDiv.querySelector("input[type='file']");

    // File upload for School Copy
    optionsSelect.onchange = () => {
        if (optionsSelect.value === "Requirement for Other School") {
            uploadDiv.classList.remove("hidden");
            fileInput.setAttribute("required", true);
        } else {
            uploadDiv.classList.add("hidden");
            fileInput.removeAttribute("required");
        }
    };

    // Trigger the change once to set upload visibility
    optionsSelect.dispatchEvent(new Event("change"));

    // Update total
    const qtyInput = fieldset.querySelector("input[name='qty[]']");
    qtyInput.addEventListener("input", () => updateTotalAmount(fieldset));
    updateTotalAmount(fieldset);
}


// Calculate total for a specific fieldset
function updateTotalAmount(fieldset) {
    const qtyInput = fieldset.querySelector("input[name='qty[]']");
    const typeSelect = fieldset.querySelector("select[name='type[]']");
    const totalSpan = fieldset.querySelector(".totalAmount");

    const qty = isNaN(qtyInput.value) || qtyInput.value <= 0 ? 1 : parseInt(qtyInput.value);
    const price = documentPrices[typeSelect.value] || 0;
    totalSpan.innerHTML = `Total Amount: ₱${(qty * price).toFixed(2)}`;
}

// Duplicate fieldset
document.addEventListener("DOMContentLoaded", () => {
    const addBtn = document.getElementById("addDoc");
    const container = document.getElementById("fieldsetsContainer");
    const warning = document.getElementById("warning1");

    // Initialize existing fieldset
    const firstFieldset = container.querySelector("fieldset");
    const typeSelect = firstFieldset.querySelector("select[name='type[]']");
    handleDocumentTypeChange(typeSelect);

    addBtn.addEventListener("click", () => {
        const fieldsets = container.querySelectorAll("fieldset");
        const lastFieldset = fieldsets[fieldsets.length - 1];

        // Check required fields
        const requiredFields = lastFieldset.querySelectorAll("[required]");
        let allFilled = true;
        requiredFields.forEach(field => {
            if (!field.value || field.value.trim() === "") allFilled = false;
        });

        if (!allFilled) {
            warning.classList.remove("hidden");
            setTimeout(() => warning.classList.add("hidden"), 2000);
            return;
        }

        // Clone fieldset
        const clone = lastFieldset.cloneNode(true);

        // Reset inputs
        clone.querySelectorAll("input, select").forEach(inp => inp.value = "");
        clone.querySelector(".upload").classList.add("hidden");
        clone.querySelector(".totalAmount").innerHTML = "";

        // Enable remove button
        const removeBtnCard = clone.querySelector("#removeDocCard");
        if (removeBtnCard) removeBtnCard.classList.remove("hidden");

        const removeBtn = clone.querySelector("#removeDoc");
        if (removeBtn) {
            removeBtn.addEventListener("click", () => clone.remove());
        }

        container.appendChild(clone);

        // Initialize new clone
        const cloneTypeSelect = clone.querySelector("select[name='type[]']");
        handleDocumentTypeChange(cloneTypeSelect);
    });
});
</script>
<script>
    // Populate Day Dropdown (1-31)
    const daySelect = document.getElementById("bDay");
    for (let i = 1; i <= 31; i++) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        daySelect.appendChild(option);
    }

    // Populate Month Dropdown (January-December) with values as words
const monthSelect = document.getElementById("bMonth");
const months = [
    "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December"
];

months.forEach(month => {
    let option = document.createElement("option");
    option.value = month; // Store month name as value
    option.textContent = month;
    monthSelect.appendChild(option);
});


    // Populate Year Dropdown (Current Year to 1980)
    const yearSelect = document.getElementById("bYear");
    const currentYear = new Date().getFullYear();

    for (let i = currentYear; i >= 1980; i--) {
        let option = document.createElement("option");
        option.value = i;
        option.textContent = i;
        yearSelect.appendChild(option);
    }
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const addBtn = document.getElementById("addDoc");
    const container = document.getElementById("fieldsetsContainer");
    const warning = document.getElementById("warning1");

    addBtn.addEventListener("click", function () {
        const fieldsets = container.querySelectorAll("fieldset");
        const lastFieldset = fieldsets[fieldsets.length - 1];

        // Check all required fields inside the last fieldset
        const requiredFields = lastFieldset.querySelectorAll("[required]");
        let allFilled = true;

        requiredFields.forEach(field => {
            if (!field.value || field.value.trim() === "") {
                allFilled = false;
            }
        });

        if (!allFilled) {
            warning.classList.remove("hidden");
            setTimeout(() => warning.classList.add("hidden"), 2000);
            return;
        }

        // Clone last fieldset
        const clone = lastFieldset.cloneNode(true);

        // Reset all inputs inside clone
        const cloneInputs = clone.querySelectorAll("input, select");
        cloneInputs.forEach(inp => {
            inp.value = "";
        });

        // Hide upload div on clone
        const uploadDiv = clone.querySelector(".upload");
        if (uploadDiv) uploadDiv.classList.add("hidden");

        // Reset total amount
        const totalSpan = clone.querySelector(".totalAmount");
        if (totalSpan) totalSpan.innerHTML = "";

        // Enable remove button for clones
        const removeBtnCard = clone.querySelector("#removeDocCard");
        if (removeBtnCard) removeBtnCard.classList.remove("hidden");

        const removeBtn = clone.querySelector("#removeDoc");
        if (removeBtn) {
            removeBtn.addEventListener("click", function () {
                clone.remove();
            });
        }

        container.appendChild(clone);
    });

    // Activate remove button on the very first cloned fieldset (hidden by default)
    const firstRemoveBtn = document.getElementById("removeDoc");
    if (firstRemoveBtn) {
        firstRemoveBtn.addEventListener("click", function () {
            if (container.children.length > 1) {
                firstRemoveBtn.closest("fieldset").remove();
            }
        });
    }
});
</script>
<script>
// Update the grand total by summing all fieldsets
function updateGrandTotal() {
    const allTotals = document.querySelectorAll(".totalAmount");
    let grandTotal = 0;

    allTotals.forEach(span => {
        // Extract numeric value from span text
        const valueText = span.textContent.replace(/[^0-9.]/g, '');
        const value = parseFloat(valueText) || 0;
        grandTotal += value;
    });

    document.getElementById("grandTotal").textContent = `₱${grandTotal.toFixed(2)}`;
}

// Override previous updateTotalAmount to also update grand total
function updateTotalAmount(fieldset) {
    const qtyInput = fieldset.querySelector("input[name='qty[]']");
    const typeSelect = fieldset.querySelector("select[name='type[]']");
    const totalSpan = fieldset.querySelector(".totalAmount");

    const qty = isNaN(qtyInput.value) || qtyInput.value <= 0 ? 1 : parseInt(qtyInput.value);
    const price = documentPrices[typeSelect.value] || 0;

    totalSpan.textContent = `₱${(qty * price).toFixed(2)}`;

    // Update grand total whenever any individual total changes
    updateGrandTotal();
}

// Call updateGrandTotal on page load in case there are existing fieldsets
document.addEventListener("DOMContentLoaded", () => {
    updateGrandTotal();
});
</script>


</body>
</html>